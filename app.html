<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zinox_pro - Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</title>
<style>
/* FONT */
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&display=swap');

:root{
  --bg-dark:#04040a;
  --panel: rgba(18,14,30,0.65);
  --accent:#7b61ff; /* Ø¨Ù†ÙØ´ Ø³Ø§ÛŒØ¨Ø±ÛŒ */
  --muted:#9aa7b3;
  --glass: rgba(255,255,255,0.02);
}

/* base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: 'Orbitron', sans-serif;
  background: var(--bg-dark);
  color: #eaf6ff;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  overflow-y:auto;
}

/* Canvas background container (fills viewport) */
#spaceBg{
  position:fixed;
  inset:0;
  z-index:0;
}

/* header */
header{
  position:relative;
  z-index:3;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 26px;
  background: linear-gradient(180deg, rgba(0,0,0,0.28), rgba(12,6,30,0.6));
  border-bottom: 1px solid rgba(255,255,255,0.03);
}
.header-title{ color:var(--accent); font-size:1.4rem; display:flex; align-items:center; gap:12px; }
.points{
  display:flex; align-items:center; gap:10px;
  background: var(--glass);
  padding:8px 12px; border-radius:10px; border:1px solid rgba(123,97,255,0.12);
}

/* points icon */
.points img{ width:28px; height:28px; display:block; opacity:0.95; transform-origin:center; animation:float 5s ease-in-out infinite; }
@keyframes float{ 0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)} }

/* main layout */
main{ position:relative; z-index:3; max-width:1100px; margin:28px auto; padding:0 16px 60px 16px; }

/* panel */
.panel{
  background: var(--panel);
  border-radius:12px;
  padding:18px;
  margin-bottom:18px;
  border:1px solid rgba(255,255,255,0.03);
  box-shadow: 0 12px 30px rgba(2,4,10,0.6);
}

/* buttons */
button, .btn{
  background: linear-gradient(180deg, rgba(123,97,255,0.12), rgba(123,97,255,0.06));
  color: #eaf6ff;
  border: 1px solid rgba(123,97,255,0.12);
  padding:10px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
  transition: transform .12s, box-shadow .12s;
}
button:hover, .btn:hover{ transform: translateY(-3px); box-shadow: 0 10px 30px rgba(3,7,20,0.6); }

/* input */
input[type="text"]{
  padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);
  background: rgba(255,255,255,0.01); color:#eaf6ff; outline:none; width:260px; font-family:inherit;
}

/* shop item */
.shop-item{ display:flex; align-items:center; gap:12px; padding:10px; border-radius:8px; margin-bottom:12px; background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent); }
.shop-item img{ width:60px; height:60px; border-radius:8px; object-fit:cover; box-shadow: 0 8px 20px rgba(0,0,0,0.6); }

/* wheel */
#wheelCanvas{ width:320px; height:320px; border-radius:50%; background: rgba(0,0,0,0.06); display:block; margin:0 auto; box-shadow: 0 10px 30px rgba(2,4,20,0.6); }

/* modal (purchase flow) */
.modal-backdrop{
  position:fixed; inset:0; background: rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; z-index:1000;
}
.modal{ background: linear-gradient(180deg, #0b0b14, #070712); padding:18px; border-radius:12px; width:420px; border:1px solid rgba(123,97,255,0.12); box-shadow:0 20px 60px rgba(0,0,0,0.7); color:#eaf6ff; }

/* loading motion for server4 */
.loader{
  width:34px;height:8px;border-radius:8px; background: linear-gradient(90deg, rgba(123,97,255,0.2), rgba(123,97,255,0.7));
  position:relative; overflow:hidden;
}
.loader::after{
  content:''; position:absolute; left:-40%; top:0; width:40%; height:100%; background: linear-gradient(90deg, rgba(255,255,255,0.08), rgba(255,255,255,0.18));
  animation: slide 1.1s linear infinite;
}
@keyframes slide{ 0%{left:-40%}100%{left:100%} }

/* small messages */
.msg{ margin-top:10px; color:var(--muted); font-size:0.95rem; }

/* responsive tweaks */
@media (max-width:760px){
  .shop-item img{ width:48px; height:48px }
  input[type="text"]{ width:100% }
  .modal{ width:92% }
}
</style>
</head>
<body>

<!-- Canvas background (drawn by JS) -->
<canvas id="spaceBg"></canvas>

<header>
  <div class="header-title">Zinox_pro - Galactic Dashboard</div>
  <div class="points" title="Ø§Ù…ØªÛŒØ§Ø² Ø´Ù…Ø§">
    <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffffff'><path d='M12 2l2.9 6.3L22 9.3l-5 4.3L18.2 22 12 18.3 5.8 22 7 13.6 2 9.3l7.1-1L12 2z'/></svg>" alt="points">
    <div>Ø§Ù…ØªÛŒØ§Ø²: <strong id="points">0</strong></div>
  </div>
</header>

<main>
  <!-- user info -->
  <div class="panel">
    <button class="btn" onclick="toggle('info')">Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±</button>
    <div id="info" class="hidden msg">
      <p>Ù†Ø§Ù…: <span id="username">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</span></p>
      <p>Discord ID: <span id="userid">...</span></p>
    </div>
  </div>

  <!-- tasks -->
  <div class="panel">
    <button class="btn" onclick="toggle('tasks')">ØªØ³Ú©â€ŒÙ‡Ø§</button>
    <div id="tasks" class="hidden" style="margin-top:12px;">
      <div style="display:flex;flex-direction:column;gap:10px;align-items:flex-start">
        <button onclick="checkDaily()">Ú†Ú© Ú©Ø±Ø¯Ù† Ø±ÙˆØ²Ø§Ù†Ù‡ Ø³Ø§ÛŒØª (Ù‡Ø± 24 Ø³Ø§Ø¹Øª)</button>
        <button onclick="joinDiscordChannel()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú†Ù†Ù„ Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯</button>

        <div>
          <button onclick="showMobileInput()">Ø«Ø¨Øª Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„</button>
          <div id="mobileInput" class="hidden" style="margin-top:10px;">
            <input type="text" id="mobile" placeholder="09xxxxxxxxx">
            <button onclick="submitMobile()">Ø«Ø¨Øª</button>
            <p id="mobileMsg" class="msg"></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- shop -->
  <div class="panel">
    <button class="btn" onclick="toggle('shop')">ÙØ±ÙˆØ´Ú¯Ø§Ù‡</button>
    <div id="shop" class="hidden" style="margin-top:12px;">
      <div class="shop-item">
        <img src="https://images.g2a.com/uiadminimages/170x226/1x1x0/discord-nitro-1-mois/f8ad240ec4b64dddbc8c9cc3" alt="">
        <div style="flex:1"><strong>Ø¨ÙˆØ³Øª Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯ 1 Ù…Ø§Ù‡Ù‡</strong><div class="msg">2000 Ø§Ù…ØªÛŒØ§Ø²</div></div>
        <button onclick="openBuyModal('Ø¨ÙˆØ³Øª Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯ 1 Ù…Ø§Ù‡Ù‡',2000,'boost')">Ø®Ø±ÛŒØ¯</button>
      </div>

      <div class="shop-item">
        <img src="https://img.freepik.com/premium-vector/premium-icon-vector-illustration-design_535345-6533.jpg" alt="">
        <div style="flex:1"><strong>Ø§Ø´ØªØ±Ø§Ú© Ù¾Ø±Ù…ÛŒÙˆÙ… Ø³Ø±ÙˆØ±Ù‡Ø§</strong><div class="msg">1400 Ø§Ù…ØªÛŒØ§Ø²</div></div>
        <button onclick="openBuyModal('Ø§Ø´ØªØ±Ø§Ú© Ù¾Ø±Ù…ÛŒÙˆÙ… Ø³Ø±ÙˆØ±Ù‡Ø§',1400,'premium')">Ø®Ø±ÛŒØ¯</button>
      </div>

      <div class="shop-item">
        <img src="https://cdn-icons-png.flaticon.com/512/6701/6701712.png" alt="">
        <div style="flex:1"><strong>ÙˆÛŒ Ø§ÛŒ Ù¾ÛŒ +</strong><div class="msg">1200 Ø§Ù…ØªÛŒØ§Ø²</div></div>
        <button onclick="openBuyModal('ÙˆÛŒ Ø§ÛŒ Ù¾ÛŒ +',1200,'vip')">Ø®Ø±ÛŒØ¯</button>
      </div>

      <div class="shop-item">
        <img src="https://limogfx.ir/wp-content/uploads/2024/04/%D8%A7%D8%B4%D8%AA%D8%B1%D8%A7%DA%A9-%D9%86%D9%82%D8%B1%D9%87-%D8%A7%DB%8C-1.webp" alt="">
        <div style="flex:1"><strong>Ø§Ø´ØªØ±Ø§Ú© Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ</strong><div class="msg">900 Ø§Ù…ØªÛŒØ§Ø²</div></div>
        <button onclick="openBuyModal('Ø§Ø´ØªØ±Ø§Ú© Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ',900,'silver')">Ø®Ø±ÛŒØ¯</button>
      </div>

      <div class="shop-item">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS7xSj1j4VpAmTuq9LBOFrnJzDJ2P95yN1Cp4cDnNjgjIJ8EFyf87q1EpKnMJ5DBetcgdU&usqp=CAU" alt="">
        <div style="flex:1"><strong>Ø§Ø´ØªØ±Ø§Ú© Ø¨Ø±Ù†Ø²</strong><div class="msg">590 Ø§Ù…ØªÛŒØ§Ø²</div></div>
        <button onclick="openBuyModal('Ø§Ø´ØªØ±Ø§Ú© Ø¨Ø±Ù†Ø²',590,'bronze')">Ø®Ø±ÛŒØ¯</button>
      </div>

      <div class="shop-item">
        <img src="https://framerusercontent.com/images/JzzTUFwDNuBVlrLsYB6bSWo8RyM.png" alt="">
        <div style="flex:1"><strong>Ø®Ø±ÛŒØ¯ Ø³Ø±ÙˆØ± Ù…Ø§ÛŒÙ†Ú©Ø±Ø§ÙØª</strong><div class="msg">30000 Ø§Ù…ØªÛŒØ§Ø²</div></div>
        <button onclick="openBuyModal('Ø®Ø±ÛŒØ¯ Ø³Ø±ÙˆØ± Ù…Ø§ÛŒÙ†Ú©Ø±Ø§ÙØª',30000,'minecraft')">Ø®Ø±ÛŒØ¯</button>
      </div>

      <p id="shopMsg" class="msg"></p>
    </div>
  </div>

  <!-- wheel -->
  <div class="panel">
    <button class="btn" onclick="toggle('wheelSection')">Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø´Ø§Ù†Ø³</button>
    <div id="wheelSection" class="hidden" style="margin-top:12px; text-align:center;">
      <canvas id="wheelCanvas" width="320" height="320"></canvas>
      <div style="height:12px"></div>
      <button id="spinBtn" class="btn" onclick="startSpin()">Ú†Ø±Ø®Ø´ Ú¯Ø±Ø¯ÙˆÙ†Ù‡</button>
      <p id="wheelMsg" class="msg"></p>
    </div>
  </div>

  <!-- redeem -->
  <div class="panel">
    <button class="btn" onclick="toggle('redeem')">ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ø±Ø¯ÛŒÙ… Ú©Ø¯</button>
    <div id="redeem" class="hidden" style="margin-top:12px;">
      <input id="redeemCode" type="text" placeholder="Ú©Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
      <button onclick="checkRedeem()">ØªØ£ÛŒÛŒØ¯</button>
      <p id="redeemMsg" class="msg"></p>
    </div>
  </div>

  <!-- servers -->
  <div class="panel">
    <button class="btn" onclick="toggle('servers')">Ø³Ø±ÙˆØ±Ù‡Ø§</button>
    <div id="servers" class="hidden" style="margin-top:12px;">
      <div style="display:flex;flex-wrap:wrap;gap:8px">
        <button onclick="server1()">Ø³Ø±ÙˆØ± 1</button>
        <button onclick="server2()">Ø³Ø±ÙˆØ± 2</button>
        <button onclick="server3()">Ø³Ø±ÙˆØ± 3</button>
        <button onclick="server4()">Ø³Ø±ÙˆØ± 4</button>
      </div>
      <img id="serverGif" class="server-gif hidden" style="margin-top:12px;width:80px;height:80px;">
      <div id="serverMsg" class="msg" style="margin-top:10px"></div>

      <div id="passwordSection" class="hidden" style="margin-top:10px">
        <input id="serverPassword" type="text" placeholder="Ù¾Ø³ÙˆØ±Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
        <button onclick="checkPassword()">ØªØ£ÛŒÛŒØ¯</button>
        <button onclick="closePassword()">Ø¨Ø³ØªÙ†</button>
        <p id="passwordMsg" class="msg"></p>
      </div>
    </div>
  </div>

</main>

<footer style="z-index:3; position:relative; text-align:center; color:var(--muted);">Â© 2025 Zinox_pro â€” Galactic Cyber Panel</footer>

<!-- Purchase Modal -->
<div id="modalRoot" style="display:none;"></div>

<script>
/* ------------------- Background canvas (dark space / subtle stars + gradient nebula) ------------------- */
(function initBackground(){
  const canvas = document.getElementById('spaceBg');
  const dpr = window.devicePixelRatio || 1;
  function resize(){
    canvas.width = innerWidth * dpr;
    canvas.height = innerHeight * dpr;
    canvas.style.width = innerWidth + 'px';
    canvas.style.height = innerHeight + 'px';
    draw();
  }
  window.addEventListener('resize', resize);
  const ctx = canvas.getContext('2d');
  // generate starfield positions
  const stars = [];
  const STAR_COUNT = 220;
  for(let i=0;i<STAR_COUNT;i++){
    stars.push({
      x: Math.random(),
      y: Math.random(),
      r: Math.random()*1.2 + 0.2,
      alpha: Math.random()*0.8 + 0.2,
      speed: Math.random()*0.00015 + 0.00005
    });
  }
  function draw(){
    const w = canvas.width, h = canvas.height;
    // background gradient (purple nebula)
    const g = ctx.createLinearGradient(0,0,w, h);
    g.addColorStop(0, '#05020a');
    g.addColorStop(0.35, '#0c0420');
    g.addColorStop(0.7, '#12042a');
    g.addColorStop(1, '#000006');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,w,h);

    // subtle nebula blobs
    const grd = ctx.createRadialGradient(w*0.2, h*0.15, 0, w*0.2, h*0.15, Math.max(w,h)*0.6);
    grd.addColorStop(0, 'rgba(123,97,255,0.08)');
    grd.addColorStop(1, 'rgba(0,0,0,0)');
    ctx.fillStyle = grd;
    ctx.fillRect(0,0,w,h);

    const grd2 = ctx.createRadialGradient(w*0.8, h*0.75, 0, w*0.8, h*0.75, Math.max(w,h)*0.6);
    grd2.addColorStop(0, 'rgba(98,60,180,0.06)');
    grd2.addColorStop(1, 'rgba(0,0,0,0)');
    ctx.fillStyle = grd2;
    ctx.fillRect(0,0,w,h);

    // stars
    const t = performance.now();
    for(const s of stars){
      const x = (s.x * w + Math.sin(t * s.speed * 0.6) * 30) % w;
      const y = (s.y * h + Math.cos(t * s.speed * 0.7) * 10) % h;
      ctx.beginPath();
      ctx.globalAlpha = s.alpha;
      ctx.fillStyle = '#ffffff';
      ctx.arc(x, y, s.r * dpr, 0, Math.PI*2);
      ctx.fill();
    }
    ctx.globalAlpha = 1;
  }
  function loop(){
    draw();
    requestAnimationFrame(loop);
  }
  resize();
  loop();
})();

/* ------------------- state ------------------- */
let points = parseInt(localStorage.getItem('bmpro_points')) || 0;
const pointsEl = document.getElementById('points');
function setPoints(v){ points = v; pointsEl.textContent = points; localStorage.setItem('bmpro_points', points); }
setPoints(points);

/* ------------------- simple helpers ------------------- */
function toggle(id){ const el=document.getElementById(id); if(!el) return; el.classList.toggle('hidden'); }

/* ------------------- user info (discord token flow) - unchanged logic ------------------- */
(function loadDiscordUser(){
  const fragment = new URLSearchParams(window.location.hash.slice(1));
  const accessToken = fragment.get("access_token");
  if(accessToken){
    fetch("https://discord.com/api/users/@me", { headers: { Authorization: `Bearer ${accessToken}` } })
      .then(r=>r.json())
      .then(user=>{
        document.getElementById("username").textContent = user.username + "#" + user.discriminator;
        document.getElementById("userid").textContent = user.id;
        localStorage.setItem("discord_user", JSON.stringify(user));
        // clean hash
        history.replaceState(null, '', location.pathname + location.search);
      }).catch(()=>{ /* ignore */ });
  } else {
    const saved = localStorage.getItem("discord_user");
    if(saved){
      const user = JSON.parse(saved);
      document.getElementById("username").textContent = user.username + "#" + user.discriminator;
      document.getElementById("userid").textContent = user.id;
    }
  }
})();

/* ------------------- tasks ------------------- */
// daily 24h
function checkDaily(){
  const last = parseInt(localStorage.getItem('bmpro_daily_last') || '0');
  const now = Date.now();
  if(last && now - last < 24*60*60*1000){
    alert("â° Ù¾Ø§Ø¯Ø§Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯Ù‡ â€” ØªØ§ 24 Ø³Ø§Ø¹Øª Ø¨Ø¹Ø¯ ØµØ¨Ø± Ú©Ù†ÛŒØ¯.");
    return;
  }
  setPoints(points + 100);
  localStorage.setItem('bmpro_daily_last', ''+now);
  alert("ğŸ‰ Ù¾Ø§Ø¯Ø§Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯: 100 Ø§Ù…ØªÛŒØ§Ø²");
}

// join Discord channel & complete task
function joinDiscordChannel(){
  window.open("https://discord.com/invite/kkdDtDcG","_blank");
  completeTask('join');
}

// mobile input
function showMobileInput(){ document.getElementById('mobileInput').classList.remove('hidden'); }
function submitMobile(){
  const mobile = (document.getElementById('mobile').value || '').trim();
  const msg = document.getElementById('mobileMsg');
  if(!/^09\d{9}$/.test(mobile)){ msg.textContent = "Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª!"; return; }
  msg.textContent = "Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ§ÛŒÛŒØ¯ Ø§Ø¯Ù…ÛŒÙ†";
  if(!localStorage.getItem('bmpro_task_mobile')){
    setPoints(points + 10);
    localStorage.setItem('bmpro_task_mobile','1');
  }
}

// complete task utility (same as before)
function completeTask(task){
  if(!localStorage.getItem('bmpro_task_'+task)){
    setPoints(points + 10);
    localStorage.setItem('bmpro_task_'+task,'1');
    alert("ØªØ¨Ø±ÛŒÚ©! Û±Û° Ø§Ù…ØªÛŒØ§Ø² Ú¯Ø±ÙØªÛŒØ¯ ğŸ‰");
  } else {
    alert("Ø§ÛŒÙ† ØªØ³Ú© Ø±Ùˆ Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ù†Ø¬Ø§Ù… Ø¯Ø§Ø¯ÛŒØ¯!");
  }
}

/* ------------------- shop purchase modal flow (restores multi-step flow) ------------------- */
function openBuyModal(title, cost, id){
  const root = document.getElementById('modalRoot');
  root.innerHTML = `
    <div class="modal-backdrop" id="modalBackdrop">
      <div class="modal" role="dialog" aria-modal="true">
        <h3 style="margin-top:0">${escapeHtml(title)}</h3>
        <p class="msg">Ù‚ÛŒÙ…Øª: ${cost} Ø§Ù…ØªÛŒØ§Ø²</p>
        <p class="msg">Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ø¢ÛŒØªÙ… Ø±Ø§ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ØŸ</p>
        <div style="display:flex;gap:10px;margin-top:14px;justify-content:flex-end">
          <button id="confirmBuy" class="btn">ØªØ£ÛŒÛŒØ¯ Ø®Ø±ÛŒØ¯</button>
          <button id="cancelBuy" class="btn">Ø§Ù†ØµØ±Ø§Ù</button>
        </div>
        <p id="modalInfo" class="msg" style="margin-top:12px"></p>
      </div>
    </div>
  `;
  root.style.display = 'block';
  document.getElementById('cancelBuy').onclick = closeModal;
  document.getElementById('confirmBuy').onclick = function(){
    // check balance
    if(points < cost){
      document.getElementById('modalInfo').textContent = 'Ø§Ù…ØªÛŒØ§Ø² Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª.';
      return;
    }
    // simulate purchase steps: deduct -> show code / instruction
    setPoints(points - cost);
    document.getElementById('modalInfo').textContent = 'Ø®Ø±ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯. Ø¨Ø±Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø³ÙØ§Ø±Ø´ Ø¨Ù‡ Ú†Ù†Ù„ Ø®Ø±ÛŒØ¯ Ø¯Ø± Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ú©Ø¯ Ø®Ø±ÛŒØ¯ Ù…Ø­ØµÙˆÙ„ Ø±Ùˆ Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ† Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯ :#i34fdfU34z.';
    // disable confirm
    document.getElementById('confirmBuy').disabled = true;
    // optional: close after short delay
    setTimeout(closeModal, 2200);
  };
}
function closeModal(){ const root=document.getElementById('modalRoot'); root.innerHTML=''; root.style.display='none'; }
function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

/* ------------------- redeem code ------------------- */
function checkRedeem(){
  const code = (document.getElementById('redeemCode').value || '').trim();
  const msg = document.getElementById('redeemMsg');
  if(!code){ msg.textContent = 'Ú©Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.'; return; }
  if(code === 'Ø§ÛŒØ±Ø§Ù† 2000'){
    setPoints(points + 200000);
    msg.textContent = 'âœ… Ú©Ø¯ Ù¾Ø°ÛŒØ±ÙØªÙ‡ Ø´Ø¯ â€” 200000 Ø§Ù…ØªÛŒØ§Ø² Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.';
  } else {
    msg.textContent = 'âŒ Ú©Ø¯ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.';
  }
}

/* ------------------- servers behavior ------------------- */
/* Requirement: password prompt ONLY for server2 and server3.
   server4: show connecting loader + "Connecting... Timeout" message
   server1: show manual IP (same as before)
*/
function clearServerUI(){ document.getElementById('serverGif').classList.add('hidden'); document.getElementById('serverGif').src=''; document.getElementById('serverMsg').textContent=''; document.getElementById('passwordSection').classList.add('hidden'); document.getElementById('passwordMsg').textContent=''; }
function server1(){ clearServerUI(); document.getElementById('serverMsg').textContent = 'ÙˆØ±ÙˆØ¯ Ø¯Ø³ØªÛŒ! Ø§ÛŒâ€ŒÙ¾ÛŒ Ø³Ø±ÙˆØ±: wii1-rFFa.aternos.me:22481'; }
function server2(){ clearServerUI(); document.getElementById('serverMsg').textContent = 'Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ØŒ Ù„Ø·ÙØ§ Ù¾Ø³ÙˆØ±Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.'; document.getElementById('passwordSection').classList.remove('hidden'); }
function server3(){ clearServerUI(); document.getElementById('serverMsg').textContent = 'Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ØŒ Ù„Ø·ÙØ§ Ù¾Ø³ÙˆØ±Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.'; document.getElementById('passwordSection').classList.remove('hidden'); }
function server4(){
  clearServerUI();
  // show loader and "Connecting... Timeout"
  const serverMsg = document.getElementById('serverMsg');
  serverMsg.innerHTML = '<div style="display:flex;align-items:center;gap:12px"><div class="loader"></div><div>Connecting... <span style="opacity:0.8">Timeout</span></div></div>';
  // simulate connecting attempt then timeout text remains
  setTimeout(()=>{ serverMsg.innerHTML = '<div class="msg">Unable to connect â€” Timeout</div>'; }, 4200);
}

function checkPassword(){
  const pass = (document.getElementById('serverPassword').value || '').trim();
  const pmsg = document.getElementById('passwordMsg');
  // previous hardcoded password was "ijff[hihfhofh" â€” keep it for consistency
  if(pass === "ijff[hihfhofh"){
    pmsg.textContent = "wii1-rFFa.aternos.me:22481";
  } else {
    pmsg.textContent = "Ù¾Ø³ÙˆØ±Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª";
  }
}
function closePassword(){ document.getElementById('passwordSection').classList.add('hidden'); }

/* ------------------- wheel implementation (weighted, smooth) ------------------- */
/*
  Items (order in wheel drawing):
   - Ù¾ÙˆÚ† (weight 0.90)
   - 5 Ø§Ù…ØªÛŒØ§Ø² (0.05)
   - 30 Ø§Ù…ØªÛŒØ§Ø² (0.03)
   - 60 Ø§Ù…ØªÛŒØ§Ø² (0.01)
   - 150 Ø§Ù…ØªÛŒØ§Ø² (0.01)
*/
const wheel = {
  items: [
    {label:'Ù¾ÙˆÚ†', points:0, weight:0.90, color:'#2b2b2b'},
    {label:'5 Ø§Ù…ØªÛŒØ§Ø²', points:5, weight:0.05, color:'#8fd6ff'},
    {label:'30 Ø§Ù…ØªÛŒØ§Ø²', points:30, weight:0.03, color:'#7ef2c6'},
    {label:'60 Ø§Ù…ØªÛŒØ§Ø²', points:60, weight:0.01, color:'#ffd57e'},
    {label:'150 Ø§Ù…ØªÛŒØ§Ø²', points:150, weight:0.01, color:'#ff9aa2'}
  ],
  canvas: document.getElementById('wheelCanvas'),
  ctx: null,
  size: 320,
  rotation: 0
};
wheel.ctx = wheel.canvas.getContext('2d');

function drawWheel(){
  const ctx = wheel.ctx;
  const s = wheel.size;
  const cx = s/2, cy = s/2, r = s/2 - 8;
  ctx.clearRect(0,0,s,s);
  const n = wheel.items.length;
  const slice = 2*Math.PI / n;

  ctx.save();
  ctx.translate(cx,cy);
  ctx.rotate(wheel.rotation);
  for(let i=0;i<n;i++){
    const start = i*slice;
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0,r,start, start+slice);
    ctx.closePath();
    ctx.fillStyle = wheel.items[i].color;
    ctx.fill();
    ctx.strokeStyle = "rgba(0,0,0,0.35)";
    ctx.lineWidth = 2;
    ctx.stroke();

    // label
    ctx.save();
    ctx.rotate(start + slice/2);
    ctx.textAlign = "right";
    ctx.fillStyle = (wheel.items[i].label === 'Ù¾ÙˆÚ†') ? '#ddd' : '#04121a';
    ctx.font = "600 14px Orbitron";
    ctx.fillText(wheel.items[i].label, r - 10, 6);
    ctx.restore();
  }
  ctx.restore();

  // draw pointer
  ctx.beginPath();
  ctx.moveTo(cx - 12, cy - r - 6);
  ctx.lineTo(cx + 12, cy - r - 6);
  ctx.lineTo(cx, cy - r + 12);
  ctx.closePath();
  ctx.fillStyle = '#ffd57e';
  ctx.fill();
  ctx.strokeStyle = 'rgba(0,0,0,0.35)';
  ctx.stroke();
}
drawWheel();

/* weighted select */
function weightedIndex(){
  const r = Math.random();
  let acc = 0;
  for(let i=0;i<wheel.items.length;i++){
    acc += wheel.items[i].weight;
    if(r <= acc) return i;
  }
  return wheel.items.length - 1;
}

let spinning = false;
function startSpin(){
  if(spinning) return;
  spinning = true;
  document.getElementById('wheelMsg').textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ú†Ø±Ø®Ø´...';
  const winIndex = weightedIndex();

  // compute target rotation such that pointer lands in center of that slice
  const n = wheel.items.length;
  const sliceDeg = 360 / n;
  const targetCenterDeg = winIndex * sliceDeg + sliceDeg/2;

  // current rotation in deg
  const currentDeg = (wheel.rotation * 180 / Math.PI) % 360;
  const spins = Math.floor(Math.random() * 3) + 4; // 4..6 full spins
  // rotate so that pointer (at 270 deg) faces the target segment center
  // pointer angle relative to wheel: 270deg
  const desiredDeg = spins * 360 + (360 - targetCenterDeg) + 270;
  const delta = desiredDeg - currentDeg;
  const duration = 4200 + Math.floor(Math.random()*800);
  const startTime = performance.now();

  function anim(now){
    const t = Math.min((now - startTime) / duration, 1);
    const ease = 1 - Math.pow(1 - t, 3);
    const deg = currentDeg + delta * ease;
    wheel.rotation = deg * Math.PI / 180;
    drawWheel();
    if(t < 1) requestAnimationFrame(anim);
    else {
      spinning = false;
      const item = wheel.items[winIndex];
      if(item.points > 0){
        setPoints(points + item.points);
        document.getElementById('wheelMsg').textContent = `ğŸ‰ Ø´Ù…Ø§ ${item.points} Ø§Ù…ØªÛŒØ§Ø² Ú¯Ø±ÙØªÛŒØ¯!`;
      } else {
        document.getElementById('wheelMsg').textContent = `ğŸ˜• Ù¾ÙˆÚ†! Ø§ÛŒÙ† Ø¨Ø§Ø± Ø´Ø§Ù†Ø³ Ø¨Ø§ Ø´Ù…Ø§ Ù†Ø¨ÙˆØ¯.`;
      }
    }
  }
  requestAnimationFrame(anim);
}

/* ------------------- init from localStorage ------------------- */
/* points already loaded; show in UI */
document.getElementById('points').textContent = points;

/* ------------------- safe utilities ------------------- */
window.openBuyModal = openBuyModal;
window.closeModal = closeModal;
window.checkRedeem = checkRedeem;
window.checkDaily = checkDaily;
window.joinDiscordChannel = joinDiscordChannel;
window.showMobileInput = showMobileInput;
window.submitMobile = submitMobile;
window.completeTask = completeTask;
window.startSpin = startSpin;
window.server1 = server1;
window.server2 = server2;
window.server3 = server3;
window.server4 = server4;
window.checkPassword = checkPassword;
window.closePassword = closePassword;

</script>
</body>
</html>
